<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity6" lang="eng">
<body>

<nav class="navbar" th:fragment="navbar">
  <div class="navbar-left">
    <a href="/" class="nav-brand">ArtisanCoffee</a>
  </div>

  <div class="navbar-right">
    <div class="dropdown" sec:authorize="isAuthenticated()">
      <button class="dropbtn" sec:authentication="name"></button>
      <div class="dropdown-content">
        <form th:if="${#authorization.expression('hasRole(''ADMIN'')')}"
              action="/h2-console" method="get" target="_blank" style="margin-bottom: 8px;">
          <button type="submit" class="regular-btn">H2 Console</button>
        </form>

        <form th:action="@{/admin}" method="get" sec:authorize="hasRole('ADMIN')">
          <button type="submit" class="regular-btn">Admin Panel</button>
        </form>

        <form th:action="@{/orders}" method="get" style="margin-top: 8px;">
          <button type="submit" class="regular-btn">My Orders</button>
        </form>

        <form action="/logout" method="post" style="display:none;" id="logoutForm">
          <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
        </form>
        <button type="button" class="logout-btn" onclick="document.getElementById('logoutForm').submit()">Logout</button>
      </div>
    </div>
    <a sec:authorize="!isAuthenticated()" href="/login" class="login-btn">Login</a>
    <a href="/cart" class="login-btn">Cart</a>
  </div>
</nav>

</body>
</html>
